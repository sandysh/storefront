(window.webpackJsonp=window.webpackJsonp||[]).push([[36],{164:function(t,s,e){"use strict";e.r(s);var n=e(0),a=Object(n.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"content"},[e("h1",{attrs:{id:"extending-express-js-server-side-routes"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#extending-express-js-server-side-routes","aria-hidden":"true"}},[t._v("#")]),t._v(" Extending Express.js server side routes")]),t._v(" "),e("p",[t._v("From Vue Storefront 1.4.0 you can add your own custom server side routes without Vue.js SSR context. These routes may be used for example for generating large unbuffered files like XML maps, binary files etc.")]),t._v(" "),e("p",[t._v("You can add numerous, custom Express js middlewares and routes by simply modifying the "),e("code",[t._v("src/server/index.js")]),t._v(":")]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{attrs:{class:"token comment"}},[t._v("// You can extend Vue Storefront server routes by binding to the Express.js (expressApp) in here")]),t._v("\nmodule"),e("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports"),e("span",{attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{attrs:{class:"token function-variable function"}},[t._v("registerUserServerRoutes")]),t._v(" "),e("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" expressApp "),e("span",{attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),e("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),e("span",{attrs:{class:"token function"}},[t._v("require")]),e("span",{attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{attrs:{class:"token string"}},[t._v("'./example/generator'")]),e("span",{attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("expressApp"),e("span",{attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("p",[t._v("The example route handler looks like this:")]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[t._v("module"),e("span",{attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{attrs:{class:"token function-variable function"}},[t._v("exports")]),t._v(" "),e("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" expressApp "),e("span",{attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),e("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),e("span",{attrs:{class:"token comment"}},[t._v("/**\n   * This is an example on how You can bind Your own Express.js server routes to SSR server running Vue Storefront.\n   * It may be usefull to avoid all the Vue.js processing and context - and useful for example for large XML/binary file generation\n   */")]),t._v("\n  expressApp"),e("span",{attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{attrs:{class:"token keyword"}},[t._v("get")]),e("span",{attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{attrs:{class:"token string"}},[t._v("'/vue-storefront.xml'")]),e("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),e("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res"),e("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),e("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    res"),e("span",{attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{attrs:{class:"token function"}},[t._v("end")]),e("span",{attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{attrs:{class:"token string"}},[t._v("'<content>Vue Storefront custom XML generator example</content>'")]),e("span",{attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),e("span",{attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("h2",{attrs:{id:"data-operations-inside-express-routes"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#data-operations-inside-express-routes","aria-hidden":"true"}},[t._v("#")]),t._v(" Data operations inside Express routes")]),t._v(" "),e("p",[t._v("Unfortunately, as you've may seen above the "),e("code",[t._v("core/scripts/server.js")]),t._v(", all modules used by the script (including the dynamic routes) can not use ES modules ("),e("code",[t._v("import ... from ...")]),t._v(" type of statements). By this limitation you can't currently use "),e("code",[t._v("@vue-storefront")]),t._v(" modules inside the custom Express.js routes as they're not compiled to the CommonJS. This is probably to be fixed. To get the data you may execute "),e("code",[t._v("fetch()")]),t._v(" requests to the "),e("code",[t._v("vue-storefront-api")]),t._v(" endpoints. You can still use "),e("code",[t._v("const config = require('config')")]),t._v(" to read the endpoints URLs etc.")])])}],!1,null,null,null);a.options.__file="extending-server-side-routes.md";s.default=a.exports}}]);